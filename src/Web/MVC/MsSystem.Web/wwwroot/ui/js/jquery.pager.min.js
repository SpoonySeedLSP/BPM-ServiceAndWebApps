//jquery 分页
(function ($) { $.fn.pager = function (options) { var defaults = { dataCount: 95, currentPage: 1, pageSize: 10, currentPageName: "p", pageSizeName: "ps", pageNumber: 5, pageName: ["首页", "上页", "下页", "尾页"], oneWrite: false, callBack: null }; var options = $.extend(defaults, options); var methods = { pageCount: 1, getCeil: function (num, div) { return Math.ceil(num / div) }, renderPager: function (options) { methods.pageCount = methods.getCeil(options.dataCount, options.pageSize); if (!options.oneWrite && methods.pageCount == 1) { return } var spaceNumber = methods.getCeil(options.pageNumber, 2); var startCount = (options.currentPage + spaceNumber) > methods.pageCount ? (methods.pageCount - options.pageNumber) : options.currentPage - (options.pageNumber - spaceNumber); startCount = startCount >= 1 ? startCount : 1; var endCount = options.currentPage < spaceNumber ? spaceNumber * 2 : options.currentPage + (options.pageNumber - spaceNumber); endCount = methods.pageCount > endCount ? endCount : methods.pageCount; startCount = ((endCount - startCount) == options.pageNumber && options.currentPage > (endCount - spaceNumber)) ? startCount + 1 : startCount; endCount = ((endCount - startCount) == options.pageNumber && options.currentPage < endCount) ? endCount - 1 : endCount; var $pager = $('<div class="pager"></div>'); if (options.pageName[0] != "") { $pager.append(options.currentPage > 1 ? methods.renderAction(options.pageName[0], 1, options.pageSize, options.callBack) : methods.renderDisabledAction(options.pageName[0])) } if (options.pageName[1] != "") { $pager.append(options.currentPage > 1 ? methods.renderAction(options.pageName[1], options.currentPage - 1, options.pageSize, options.callBack) : methods.renderDisabledAction(options.pageName[1])) } for (var i = startCount; i <= endCount; i++) { $pager.append(options.currentPage == i ? methods.renderAction(i, i, options.pageSize, options.callBack, true) : methods.renderAction(i, i, options.pageSize, options.callBack)) } if (options.pageName[2] != "") { $pager.append(options.currentPage < endCount ? methods.renderAction(options.pageName[2], options.currentPage + 1, options.pageSize, options.callBack) : methods.renderDisabledAction(options.pageName[2])) } if (options.pageName[3] != "") { $pager.append(options.currentPage < methods.pageCount ? methods.renderAction(options.pageName[3], methods.pageCount, options.pageSize, options.callBack) : methods.renderDisabledAction(options.pageName[3])) } $pager.append("<span>" + options.currentPage + "/" + methods.pageCount + "页</span>"); $pager.append("<span>共" + options.dataCount + "条</span>"); return $pager }, getQueryString: function (options) { var query = document.location.search.substr(1); if (query == "") { return "" } var querys = query.split("&"); var querystring = ""; for (var i = 0; i < querys.length; i++) { var temp = querys[i].split("="); if (temp.length < 2) { continue } if (temp[0] == options.currentPageName || temp[0] == options.pageSizeName) { continue } querystring += temp[0] + "=" + temp[1] + "&" } return querystring }, renderAction: function (txt, currentPage, pageSize, callBack, isCurrent) { var $action = $("<a " + (isCurrent ? 'class="current"' : "") + ' href="javascript:void(0);">' + txt + "</a>"); if (!isCurrent) { $action.click(function () { var querystring = methods.getQueryString(options); document.location.href = "?" + querystring + options.currentPageName + "=" + currentPage + "&" + options.pageSizeName + "=" + pageSize; if (callBack) { callBack(currentPage) } }) } return $action }, renderDisabledAction: function (txt) { return '<a class="disabled" href="javascript:void(0);">' + txt + "</a>" } }; this.each(function () { $(this).empty().append(methods.renderPager(options)) }) } })(jQuery);